/// 訂單主表
model Order {
  /// 主鍵 ID
  id              String      @id @default(cuid())
  /// 訂單編號（唯一）
  orderNumber     String      @unique
  /// 訂單狀態
  status          OrderStatus @default(PENDING)
  /// 訂單總金額
  total           Float
  /// 使用者 ID
  userId          String
  /// 配送地址（JSON 格式）
  shippingAddress Json?
  /// 帳單地址（JSON 格式）
  billingAddress  Json?
  /// 付款方式
  paymentMethod   String?
  /// 第三方支付交易 ID
  paymentId       String?
  /// 訂單建立時間
  createdAt       DateTime    @default(now())
  /// 訂單更新時間
  updatedAt       DateTime    @updatedAt
  /// 關聯使用者
  user            Profile     @relation(fields: [userId], references: [id])
  /// 訂單項目列表
  items           OrderItem[]

  @@schema("public")
}

/// 訂單項目
model OrderItem {
  /// 主鍵 ID
  id          String  @id @default(cuid())
  /// 購買數量
  quantity    Int
  /// 單價
  unitPrice   Float
  /// 小計金額
  totalPrice  Float
  /// 訂單 ID
  orderId     String
  /// 商品 ID
  productId   String
  /// 購買時的規格資訊快照（JSON 格式）
  variantData Json?
  /// 關聯訂單
  order       Order   @relation(fields: [orderId], references: [id], onDelete: Cascade)
  /// 關聯商品
  product     Product @relation(fields: [productId], references: [id])

  @@schema("public")
}

/// 訂單狀態
enum OrderStatus {
  /// 待處理
  PENDING
  /// 處理中
  PROCESSING
  /// 已出貨
  SHIPPED
  /// 已送達
  DELIVERED
  /// 已取消
  CANCELLED
  /// 已退款
  REFUNDED

  @@schema("public")
}
